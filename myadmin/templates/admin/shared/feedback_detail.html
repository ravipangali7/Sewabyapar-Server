{% extends 'admin/layouts/base.html' %}
{% block content %}
<div class="container-fluid p-0">
    <div class="mb-3"><h1 class="h3 d-inline align-middle">Feedback/Complaint Details</h1><a class="btn btn-primary ms-2" href="{% url 'myadmin:shared:feedback_update' feedback.pk %}">Edit</a><a class="btn btn-danger ms-2" href="{% url 'myadmin:shared:feedback_delete' feedback.pk %}">Delete</a><a class="btn btn-secondary ms-2" href="{% url 'myadmin:shared:feedback_list' %}">Back</a></div>
    <div class="row"><div class="col-md-6"><div class="card"><div class="card-header"><h5 class="card-title mb-0">Feedback/Complaint Information</h5></div><div class="card-body">
        <dl class="row"><dt class="col-sm-4">User:</dt><dd class="col-sm-8">{{ feedback.user.name }}</dd><dt class="col-sm-4">Subject:</dt><dd class="col-sm-8">{{ feedback.subject }}</dd><dt class="col-sm-4">Type:</dt><dd class="col-sm-8"><span class="badge bg-{% if feedback.type == 'feedback' %}info{% else %}warning{% endif %}">{{ feedback.get_type_display }}</span></dd><dt class="col-sm-4">Status:</dt><dd class="col-sm-8"><span class="badge bg-{% if feedback.status == 'resolved' %}success{% elif feedback.status == 'pending' %}warning{% elif feedback.status == 'closed' %}secondary{% else %}info{% endif %}">{{ feedback.get_status_display }}</span></dd><dt class="col-sm-4">Message:</dt><dd class="col-sm-8">{{ feedback.message }}</dd><dt class="col-sm-4">Created:</dt><dd class="col-sm-8">{{ feedback.created_at|date:"M d, Y H:i" }}</dd></dl>
        <form method="post" action="{% url 'myadmin:shared:feedback_update_status' feedback.pk %}" class="mt-3">{% csrf_token %}<div class="input-group"><select class="form-select" name="status">{% for value, label in feedback.STATUS_CHOICES %}<option value="{{ value }}" {% if feedback.status == value %}selected{% endif %}>{{ label }}</option>{% endfor %}</select><button type="submit" class="btn btn-primary">Update Status</button></div></form>
    </div></div></div><div class="col-md-6"><div class="card"><div class="card-header"><h5 class="card-title mb-0">Replies</h5></div><div class="card-body">
        <a href="{% url 'myadmin:shared:feedback_reply_create' %}" class="btn btn-sm btn-primary mb-3">Add Reply</a>
        {% for reply in feedback.replies.all %}<div class="mb-3 p-2 border"><strong>{% if reply.is_admin_reply %}Admin{% else %}{{ reply.user.name }}{% endif %}:</strong> {{ reply.message }}<br><small class="text-muted">{{ reply.created_at|date:"M d, Y H:i" }}</small></div>{% empty %}<p class="text-muted">No replies yet</p>{% endfor %}
    </div></div></div></div>
</div>
{% endblock %}

